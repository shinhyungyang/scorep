if HAVE_ONLINE_ACCESS_HEADERS

check_PROGRAMS += oa_c_test

oa_c_test_SOURCES =                                       \
	$(SRC_ROOT)/test/OA/serial/C/oa_test.c

oa_c_test_CPPFLAGS = $(AM_CPPFLAGS) @COMPILER_INSTRUMENTATION_CPPFLAGS@       \
    -I$(INC_ROOT)src/adapters/include       \
    -I$(INC_ROOT)include/scorep				\
    -I$(INC_ROOT)src/measurement/include    \
    -I$(PUBLIC_INC_DIR)                     \
    -I$(INC_DIR_UTIL)                       \
    -DSCOREP_USER_ENABLE

if SCOREP_COMPILER_IBM
oa_c_test_CPPFLAGS += -WF,-DSCOREP_USER_ENABLE=1
else
oa_c_test_CPPFLAGS += -DSCOREP_USER_ENABLE=1
endif

if SCOREP_COMPILER_PGI
oa_c_test_CPPFLAGS += -DSCOREP_COMPILER_PGI=1
endif

oa_c_test_LDADD =                        \
    $(LIB_ROOT)libscorep_serial.la         \
    $(LIB_ROOT)libscorep_pomp_dummy.la     \
    $(LIB_DIR_OTF2)libotf2.la              \
    $(LIB_DIR_UTIL)libscorep_utilities.la

if HAVE_PAPI
oa_c_test_LDFLAGS = $(SCOREP_PAPI_LDFLAGS) $(SCOREP_PAPI_LIBS) -Wl,-rpath,$(SCOREP_PAPI_LIBDIR)
endif

EXTRA_DIST       += \
    $(SRC_ROOT)/test/OA/serial/C/run_oa_c_test.sh

TESTS_SERIAL += $(srcdir)/../test/OA/serial/C/run_oa_c_test.sh

endif #if HAVE_ONLINE_ACCESS_HEADERS
